
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.15">
    
    
      
        <title>Plugins - Nixago Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.c382b1dc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cc9b2e1e.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#creating-plugins" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Nixago Docs" class="md-header__button md-logo" aria-label="Nixago Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Nixago Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Plugins
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/jmgilman/nixago" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    nixago
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Nixago Docs" class="md-nav__button md-logo" aria-label="Nixago Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Nixago Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/jmgilman/nixago" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    nixago
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../quick_start/" class="md-nav__link">
        Quick Start
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Plugins
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Plugins" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Plugins
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../plugins/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../plugins/just/" class="md-nav__link">
        Just
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../plugins/pre-commit/" class="md-nav__link">
        Pre-commit
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../plugins/prettier/" class="md-nav__link">
        Prettier
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Contributing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Contributing" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Contributing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../design/" class="md-nav__link">
        Design
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Plugins
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Plugins
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#checklist" class="md-nav__link">
    Checklist
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-a-plugin" class="md-nav__link">
    Creating a Plugin
  </a>
  
    <nav class="md-nav" aria-label="Creating a Plugin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-the-cue-file" class="md-nav__link">
    Creating the CUE file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-the-nix-functions" class="md-nav__link">
    Creating the Nix Functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#writing-tests-and-documentation" class="md-nav__link">
    Writing Tests and Documentation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#checklist" class="md-nav__link">
    Checklist
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-a-plugin" class="md-nav__link">
    Creating a Plugin
  </a>
  
    <nav class="md-nav" aria-label="Creating a Plugin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-the-cue-file" class="md-nav__link">
    Creating the CUE file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-the-nix-functions" class="md-nav__link">
    Creating the Nix Functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#writing-tests-and-documentation" class="md-nav__link">
    Writing Tests and Documentation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/jmgilman/nixago/edit/master/docs/contributing/plugins.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



<h1 id="creating-plugins">Creating Plugins</h1>
<p>Contributing plugins to Nixago is a multi-step process. Fortunately, the design
of Nixago makes these steps relatively straightforward.</p>
<h2 id="checklist">Checklist</h2>
<p>The following is a useful checklist to go over before submitting a PR:</p>
<ol>
<li>Is the plugin named after the tool it supports?</li>
<li>Does the plugin have a dedicated directory under <a href="https://github.com/jmgilman/nixago/tree/master/plugins">plugins</a>?</li>
<li>Was the plugin added to the main <a href="https://github.com/jmgilman/nixago/blob/master/plugins/default.nix">default.nix</a>?</li>
<li>Does the plugin have tests written for it?</li>
<li>Have the tests been added to the <a href="https://github.com/jmgilman/nixago/blob/master/flake.nix">flake.nix</a> <code>checks</code> output?</li>
<li>Does the plugin have a dedicated page in the documentation?</li>
</ol>
<p>If you answered yes to all of the above questions you are ready to submit a PR!</p>
<h2 id="creating-a-plugin">Creating a Plugin</h2>
<p>Creating a plugin encompasses three primary tasks:</p>
<ol>
<li>Create a CUE file</li>
<li>Create the Nix functions</li>
<li>Write tests and documentation</li>
</ol>
<p>Each plugin should be isolated to a dedicated directory under <a href="https://github.com/jmgilman/nixago/tree/master/plugins">plugins</a>. The
first step is to create a new directory with the name of the plugin. The name
should ideally indicate the tool that it supports (i.e. the plugin for the
Prettier formatter is simply called <code>prettier</code>).</p>
<p>The remainder of this section will walk through creating a plugin for the
<a href="https://pre-commit.com/">pre-commit</a> CLI tool. The plugin will generate a <code>.pre-commit-config.yaml</code>
file which is used to configure the pre-commit tool.</p>
<h3 id="creating-the-cue-file">Creating the CUE file</h3>
<p>Review the <a href="../design/#cue">CUE section</a> of the design page for more information
about CUE. Each plugin typically utilizes a single CUE file, although more
advanced cases may require multiple files. The file should be called
<code>template.cue</code>.</p>
<p>When creating the CUE file, keep the following in mind:</p>
<ul>
<li>
<p>The schema defined in the file should be sufficient enough to prevent most
  configuration mistakes.</p>
</li>
<li>
<p>If the tool being supported has rich documentation around valid values for
  each configuration field, use constraints to improve the accuracy of the schema.</p>
</li>
<li>
<p>Don't be overly strict with the schema definition. The goal is to be helpful
  and not generate a large number of false negatives.</p>
</li>
</ul>
<p>Here is the <code>template.nix</code> file for our pre-commit plugin:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a>#Config: {
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>    default_install_hook_types?: [...string]
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>    default_language_version?: [string]: string
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>    default_stages?: [...string]
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>    files?: string
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>    exclude?: string
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>    fail_fast?: bool
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>    minimum_pre_commit_version?: string
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>    repos: [...#Repo]
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>}
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>#Hook: {
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    additional_dependencies?: [...string]
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>    alias?: string
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>    always_run?: bool
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>    args?: [...string]
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    entry?: string
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    exclude?: string
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    exclude_types?: [...string]
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    files?: string
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    id: string
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    language?: string
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    language_version?: string
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    log_file?: string
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    name?: string
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>    stages?: [...string]
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>    types?: [...string]
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    types_or?: [...string]
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    verbose?: bool
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>}
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>#Repo: {
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    repo: string
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    rev?: string
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    if repo != &quot;local&quot; {
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>        rev: string
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    }
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    hooks: [...#Hook]
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>}
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>{
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    #Config
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>}
</code></pre></div></td></tr></table></div>
<p>This file defines three <a href="https://cuetorials.com/overview/types-and-values/#definitions">definitions</a>, notated by the <code>#</code> symbol. A
definition can be thought of as a schema or contract. It defines the shape of
valid data through various constraints. Let's break one down:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span>
<span class="normal"><a href="#__codelineno-1-2">2</a></span>
<span class="normal"><a href="#__codelineno-1-3">3</a></span>
<span class="normal"><a href="#__codelineno-1-4">4</a></span>
<span class="normal"><a href="#__codelineno-1-5">5</a></span>
<span class="normal"><a href="#__codelineno-1-6">6</a></span>
<span class="normal"><a href="#__codelineno-1-7">7</a></span>
<span class="normal"><a href="#__codelineno-1-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a>#Repo: {
<a id="__codelineno-1-2" name="__codelineno-1-2"></a>    repo: string
<a id="__codelineno-1-3" name="__codelineno-1-3"></a>    rev?: string
<a id="__codelineno-1-4" name="__codelineno-1-4"></a>    if repo != &quot;local&quot; {
<a id="__codelineno-1-5" name="__codelineno-1-5"></a>        rev: string
<a id="__codelineno-1-6" name="__codelineno-1-6"></a>    }
<a id="__codelineno-1-7" name="__codelineno-1-7"></a>    hooks: [...#Hook]
<a id="__codelineno-1-8" name="__codelineno-1-8"></a>}
</code></pre></div></td></tr></table></div>
<p>The <code>pre-commit-config.yaml</code> file has a <code>repos</code> field which is a list of
repositories that pre-commit should build from. The <code>#Repo</code> definition provides
the schema for these entries. Each entry must have a <code>repo</code> field which is a
string value. The <code>rev</code> field is an interesting one: it's only optional if the
<code>repo</code> field is set to "local". The above first sets the <code>rev</code> field to optional
using the <code>?</code> symbol and then conditonally sets it to required based on the
value of <code>repo</code>. Finally, each entry has a list of hooks, denoted by the
<code>[...#Hooks]</code> syntax.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span>
<span class="normal"><a href="#__codelineno-2-2">2</a></span>
<span class="normal"><a href="#__codelineno-2-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a>{
<a id="__codelineno-2-2" name="__codelineno-2-2"></a>    #Config
<a id="__codelineno-2-3" name="__codelineno-2-3"></a>}
</code></pre></div></td></tr></table></div>
<p>This final bit is where we define the actual elements of the CUE file. This is
what will appear when we evaluate the CUE file. In the above case, we're saying
the input data should be a <a href="https://cuetorials.com/overview/types-and-values/#structs">struct</a> which conforms to the schema defined by
<code>#Config</code>.</p>
<p>In this case, we're doing no additional transformations to the incoming data.
This is because we're expecting the input data to already be in the format
expected in the <code>.pre-commit-config.yaml</code> file. Since YAML is a superset of
JSON, we can easily ask CUE to evaluate the input and produce a YAML output.</p>
<h3 id="creating-the-nix-functions">Creating the Nix Functions</h3>
<p>With the CUE file created, the next step is to create our main Nix function. In
this case, we're going to create a single function for generating our
configuration file.</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Nix</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-3-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-3-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-3-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-3-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-3-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-3-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-3-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-3-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-3-10">10</a></span>
<span class="normal"><a href="#__codelineno-3-11">11</a></span>
<span class="normal"><a href="#__codelineno-3-12">12</a></span>
<span class="normal"><a href="#__codelineno-3-13">13</a></span>
<span class="normal"><a href="#__codelineno-3-14">14</a></span>
<span class="normal"><a href="#__codelineno-3-15">15</a></span>
<span class="normal"><a href="#__codelineno-3-16">16</a></span>
<span class="normal"><a href="#__codelineno-3-17">17</a></span>
<span class="normal"><a href="#__codelineno-3-18">18</a></span>
<span class="normal"><a href="#__codelineno-3-19">19</a></span>
<span class="normal"><a href="#__codelineno-3-20">20</a></span>
<span class="normal"><a href="#__codelineno-3-21">21</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="p">{</span> pkgs<span class="p">,</span> lib <span class="p">}:</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a>data<span class="p">:</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="k">with</span> pkgs<span class="o">.</span>lib<span class="p">;</span>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="k">let</span>
<a id="__codelineno-3-5" name="__codelineno-3-5"></a>  <span class="ss">files =</span> <span class="p">[</span> <span class="o">.</span><span class="l">/template.cue</span> <span class="p">];</span>
<a id="__codelineno-3-6" name="__codelineno-3-6"></a>  <span class="ss">output =</span> <span class="s2">&quot;.pre-commit-config.yaml&quot;</span><span class="p">;</span>
<a id="__codelineno-3-7" name="__codelineno-3-7"></a>  <span class="ss">pre-commit =</span> pkgs<span class="o">.</span>pre-commit<span class="p">;</span>
<a id="__codelineno-3-8" name="__codelineno-3-8"></a>
<a id="__codelineno-3-9" name="__codelineno-3-9"></a>  <span class="c1"># Add an extra hook for reinstalling required stages whenever the file changes</span>
<a id="__codelineno-3-10" name="__codelineno-3-10"></a>  <span class="ss">stages =</span> unique <span class="p">(</span>flatten <span class="p">(</span><span class="nb">builtins</span><span class="o">.</span><span class="nb">map</span> <span class="p">(</span>repo<span class="p">:</span> <span class="nb">builtins</span><span class="o">.</span><span class="nb">map</span> <span class="p">(</span>hook<span class="p">:</span> optionals <span class="p">(</span>hook <span class="o">?</span> stages<span class="p">)</span> hook<span class="o">.</span>stages<span class="p">)</span> repo<span class="o">.</span>hooks<span class="p">)</span> data<span class="o">.</span>repos<span class="p">)</span> <span class="o">++</span> <span class="p">[</span> <span class="s2">&quot;pre-commit&quot;</span> <span class="p">]);</span>
<a id="__codelineno-3-11" name="__codelineno-3-11"></a>  <span class="ss">stagesStr =</span> <span class="nb">builtins</span><span class="o">.</span>concatStringsSep <span class="s2">&quot; &quot;</span> stages<span class="p">;</span>
<a id="__codelineno-3-12" name="__codelineno-3-12"></a>  <span class="ss">shellHookExtra =</span> <span class="p">(</span><span class="nb">import</span> <span class="o">.</span><span class="l">/common.nix</span> <span class="p">{</span> <span class="k">inherit</span> pre-commit stagesStr<span class="p">;</span> <span class="p">})</span><span class="o">.</span>shellHookExtra<span class="p">;</span>
<a id="__codelineno-3-13" name="__codelineno-3-13"></a>
<a id="__codelineno-3-14" name="__codelineno-3-14"></a>  <span class="c1"># Generate the module</span>
<a id="__codelineno-3-15" name="__codelineno-3-15"></a>  <span class="ss">result =</span> lib<span class="o">.</span>mkTemplate <span class="p">{</span>
<a id="__codelineno-3-16" name="__codelineno-3-16"></a>    <span class="k">inherit</span> data files output shellHookExtra<span class="p">;</span>
<a id="__codelineno-3-17" name="__codelineno-3-17"></a>  <span class="p">};</span>
<a id="__codelineno-3-18" name="__codelineno-3-18"></a><span class="k">in</span>
<a id="__codelineno-3-19" name="__codelineno-3-19"></a><span class="p">{</span>
<a id="__codelineno-3-20" name="__codelineno-3-20"></a>  <span class="k">inherit</span> <span class="p">(</span>result<span class="p">)</span> configFile shellHook<span class="p">;</span>
<a id="__codelineno-3-21" name="__codelineno-3-21"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>All functions maintain the same basic structure. At the top we accept an
attribute set as the first argument which pulls in local copies of <code>nixpkgs</code>
and the internal <code>lib</code> provided by the flake. The second argument should always
be named <code>data</code> and will contain the data passed in by the end-user.</p>
<p>The top of the function should declare the <code>files</code> and <code>output</code> variables. The
<code>files</code> variable should point to the CUE file we previously created. The
<code>output</code> variable should contain the name of the configuration file the plugin
is generating. Note that the extension of the configuration file is important.
CUE uses the file extension to determine what format to output when our CUE file
is evaluated. <a href="https://cuelang.org/docs/integrations/">See here</a> for supported formats.</p>
<p>The remainder of the function is specific to each plugin. In the case above,
we gather all of the pre-commit <code>stages</code> settings to determine what stages of
the pre-commit process should be installed when the configuration is generated.
We then create <code>shellHookExtra</code> which contains the necessary logic for
installing the stages.</p>
<p>At the very end, the internal <code>mkTemplate</code> function is called. For more details
about this function, <a href="../design/#templates">see here</a>.</p>
<p>In order for our plugin to be picked up by the main flake, we must take two
additional steps. The first is creating a <code>default.nix</code> in our plugin directory
that exports our function:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Nix</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span>
<span class="normal"><a href="#__codelineno-4-2">2</a></span>
<span class="normal"><a href="#__codelineno-4-3">3</a></span>
<span class="normal"><a href="#__codelineno-4-4">4</a></span>
<span class="normal"><a href="#__codelineno-4-5">5</a></span>
<span class="normal"><a href="#__codelineno-4-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="p">{</span> pkgs<span class="p">,</span> lib <span class="p">}:</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="p">{</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a>  <span class="cm">/* Creates a .pre-commit-config.yaml file for configuring pre-commit.</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="cm">  */</span>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a>  <span class="ss">mkConfig =</span> <span class="nb">import</span> <span class="o">.</span><span class="l">/mkConfig.nix</span> <span class="p">{</span> <span class="k">inherit</span> pkgs lib<span class="p">;</span> <span class="p">};</span>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>This will allow the <code>mkConfig</code> function to be accessible under
<code>nixago.plugins.{myPlugin}.mkConfig</code>. Finally, we must create an entry in the
main <code>default.nix</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Nix</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-5-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-5-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-5-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-5-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-5-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-5-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-5-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-5-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-5-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="p">{</span> pkgs<span class="p">,</span> lib <span class="p">}:</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="p">{</span>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a>  <span class="c1"># ...</span>
<a id="__codelineno-5-4" name="__codelineno-5-4"></a>
<a id="__codelineno-5-5" name="__codelineno-5-5"></a>  <span class="cm">/* https://github.com/pre-commit/pre-commit</span>
<a id="__codelineno-5-6" name="__codelineno-5-6"></a><span class="cm">  */</span>
<a id="__codelineno-5-7" name="__codelineno-5-7"></a>  <span class="ss">pre-commit =</span> <span class="nb">import</span> <span class="o">.</span><span class="l">/pre-commit</span> <span class="p">{</span> <span class="k">inherit</span> pkgs lib<span class="p">;</span> <span class="p">};</span>
<a id="__codelineno-5-8" name="__codelineno-5-8"></a>
<a id="__codelineno-5-9" name="__codelineno-5-9"></a>  <span class="c1"># ....</span>
<a id="__codelineno-5-10" name="__codelineno-5-10"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>This registers the plugin to make it accessible from <code>nixago.plugins</code>.</p>
<h3 id="writing-tests-and-documentation">Writing Tests and Documentation</h3>
<p>The final step is to write tests and documentation for the plugin. Tests are
added in the <a href="https://github.com/jmgilman/nixago/tree/master/tests">tests</a> directory in a dedicated directory named after the
plugin. Tests are fairly trivial to write.</p>
<p>The first step is to create a <code>default.nix</code> which runs the test:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Nix</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-6-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-6-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-6-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-6-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-6-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-6-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-6-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-6-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-6-10">10</a></span>
<span class="normal"><a href="#__codelineno-6-11">11</a></span>
<span class="normal"><a href="#__codelineno-6-12">12</a></span>
<span class="normal"><a href="#__codelineno-6-13">13</a></span>
<span class="normal"><a href="#__codelineno-6-14">14</a></span>
<span class="normal"><a href="#__codelineno-6-15">15</a></span>
<span class="normal"><a href="#__codelineno-6-16">16</a></span>
<span class="normal"><a href="#__codelineno-6-17">17</a></span>
<span class="normal"><a href="#__codelineno-6-18">18</a></span>
<span class="normal"><a href="#__codelineno-6-19">19</a></span>
<span class="normal"><a href="#__codelineno-6-20">20</a></span>
<span class="normal"><a href="#__codelineno-6-21">21</a></span>
<span class="normal"><a href="#__codelineno-6-22">22</a></span>
<span class="normal"><a href="#__codelineno-6-23">23</a></span>
<span class="normal"><a href="#__codelineno-6-24">24</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="p">{</span> pkgs<span class="p">,</span> plugins <span class="p">}:</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="k">let</span>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a>  <span class="ss">output =</span> plugins<span class="o">.</span>pre-commit<span class="o">.</span>mkConfig <span class="p">{</span>
<a id="__codelineno-6-4" name="__codelineno-6-4"></a>    <span class="ss">repos =</span> <span class="p">[</span>
<a id="__codelineno-6-5" name="__codelineno-6-5"></a>      <span class="p">{</span>
<a id="__codelineno-6-6" name="__codelineno-6-6"></a>        <span class="ss">repo =</span> <span class="s2">&quot;https://github.com/my/repo&quot;</span><span class="p">;</span>
<a id="__codelineno-6-7" name="__codelineno-6-7"></a>        <span class="ss">rev =</span> <span class="s2">&quot;1.0&quot;</span><span class="p">;</span>
<a id="__codelineno-6-8" name="__codelineno-6-8"></a>        <span class="ss">hooks =</span> <span class="p">[</span>
<a id="__codelineno-6-9" name="__codelineno-6-9"></a>          <span class="p">{</span>
<a id="__codelineno-6-10" name="__codelineno-6-10"></a>            <span class="ss">id =</span> <span class="s2">&quot;my-hook&quot;</span><span class="p">;</span>
<a id="__codelineno-6-11" name="__codelineno-6-11"></a>          <span class="p">}</span>
<a id="__codelineno-6-12" name="__codelineno-6-12"></a>        <span class="p">];</span>
<a id="__codelineno-6-13" name="__codelineno-6-13"></a>      <span class="p">}</span>
<a id="__codelineno-6-14" name="__codelineno-6-14"></a>    <span class="p">];</span>
<a id="__codelineno-6-15" name="__codelineno-6-15"></a>  <span class="p">};</span>
<a id="__codelineno-6-16" name="__codelineno-6-16"></a>
<a id="__codelineno-6-17" name="__codelineno-6-17"></a>  <span class="ss">result =</span> pkgs<span class="o">.</span>runCommand <span class="s2">&quot;test.pre-commit&quot;</span>
<a id="__codelineno-6-18" name="__codelineno-6-18"></a>    <span class="p">{</span> <span class="p">}</span>
<a id="__codelineno-6-19" name="__codelineno-6-19"></a>    <span class="s1">&#39;&#39;</span>
<a id="__codelineno-6-20" name="__codelineno-6-20"></a><span class="s1">      cmp &quot;</span><span class="si">${</span><span class="o">.</span><span class="l">/expected.yml</span><span class="si">}</span><span class="s1">&quot; &quot;</span><span class="si">${</span>output<span class="o">.</span>configFile<span class="si">}</span><span class="s1">&quot;</span>
<a id="__codelineno-6-21" name="__codelineno-6-21"></a><span class="s1">      touch $out</span>
<a id="__codelineno-6-22" name="__codelineno-6-22"></a><span class="s1">    &#39;&#39;</span><span class="p">;</span>
<a id="__codelineno-6-23" name="__codelineno-6-23"></a><span class="k">in</span>
<a id="__codelineno-6-24" name="__codelineno-6-24"></a>result
</code></pre></div></td></tr></table></div>
<p>The test is made up of two parts: a sample configuration is generated and then
it is compared to a known expected output. The test will be provided an instance
of <code>plugins</code> in order to access functions for testing. The usage of <code>runCommand</code>
in the second part wil necessarily build the derivation which is returned from
the function.</p>
<p>The second step is to create the expected output. In this case, the above
invocation should create the following output:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">YAML</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1">1</a></span>
<span class="normal"><a href="#__codelineno-7-2">2</a></span>
<span class="normal"><a href="#__codelineno-7-3">3</a></span>
<span class="normal"><a href="#__codelineno-7-4">4</a></span>
<span class="normal"><a href="#__codelineno-7-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="nt">repos</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hooks</span><span class="p">:</span><span class="w"></span>
<a id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-hook</span><span class="w"></span>
<a id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="w">    </span><span class="nt">repo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/my/repo</span><span class="w"></span>
<a id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="w">    </span><span class="nt">rev</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.0&quot;</span><span class="w"></span>
</code></pre></div></td></tr></table></div>
<p>The generateed output will be compared to this and the test will fail if a
difference is found.</p>
<p>The final step is to add the tests to the <code>checks</code> output in the main
<code>flake.nix</code> file:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Nix</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span>
<span class="normal"><a href="#__codelineno-8-2">2</a></span>
<span class="normal"><a href="#__codelineno-8-3">3</a></span>
<span class="normal"><a href="#__codelineno-8-4">4</a></span>
<span class="normal"><a href="#__codelineno-8-5">5</a></span>
<span class="normal"><a href="#__codelineno-8-6">6</a></span>
<span class="normal"><a href="#__codelineno-8-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="p">{</span>
<a id="__codelineno-8-2" name="__codelineno-8-2"></a>    <span class="ss">checks =</span> <span class="p">{</span>
<a id="__codelineno-8-3" name="__codelineno-8-3"></a>        <span class="c1">#...</span>
<a id="__codelineno-8-4" name="__codelineno-8-4"></a>        <span class="ss">pre-commit =</span> pkgs<span class="o">.</span>callPackage <span class="o">.</span><span class="l">/tests/pre-commit</span> <span class="p">{</span> <span class="k">inherit</span> pkgs plugins<span class="p">;</span> <span class="p">};</span>
<a id="__codelineno-8-5" name="__codelineno-8-5"></a>        <span class="c1">#...</span>
<a id="__codelineno-8-6" name="__codelineno-8-6"></a>    <span class="p">};</span>
<a id="__codelineno-8-7" name="__codelineno-8-7"></a><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Finally, before submitting a PR, documentation should be added under the
<a href="https://github.com/jmgilman/nixago/tree/master/docs/plugins">plugins</a> section of the documentation. This should cover general usage
information about the plugin including an example invocation.</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../design/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Design" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Design
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.a6c66575.min.js"></script>
      
    
  </body>
</html>